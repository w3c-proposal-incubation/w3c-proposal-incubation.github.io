<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bullet Chatting Proposal</title>
  <meta charset='utf-8'>
  <script src='https://www.w3.org/Tools/respec/respec-w3c' async class='remove'></script>
  <script class='remove'>
    var respecConfig = {
      specStatus: "ED",
      edDraftURI: "https://w3c-proposal-incubation.github.io/danmaku-proposal/",
      shortName: "danmaku",
      editors: [{
        name: "Zhihao Huang",
        companyURL: "https://www.bilibili.com/",
        company: "‎Bilibili Inc."

      }, {
        name: "Song Xu",
        companyURL: 'http://www.migu.cn',
        company: "China Mobile"

      }],
      authors: [{
        name: "Fuqiao Xue",
        companyURL: "http://www.chinaw3c.org/",
        company: "W3C"
      }, {
        name: "Lei Zhao",
        companyURL: "http://www.migu.cn",
        company: "China Mobile"
      }, {
        name: "Zhaoqin Tan",
        companyURL: "https://www.bilibili.com/",
        company: "Bilibili Inc."
      }, {
        name: "Yajun Chen",
        companyURL: 'http://www.migu.cn',
        company: "China Mobile"
      }],
      wg: "Chinese Web Interest Group",
      wgURI: "https://www.w3.org/2018/chinese-web-ig/",
      charterDisclosureURI: "https://www.w3.org/2004/01/pp-impl/109611/status",
      github: {
        repoURL: "https://github.com/w3c-proposal-incubation/danmaku-proposal",
        branch: "master"
      },
      processVersion: 2019,
    };
  </script>
</head>

<body>
  <section id='abstract'>
    <p>
     This document provides use cases and requirements for Danmaku, and propose a few Web APIs to easily enable Danmaku in the Web Browsers.
    </p>
  </section>
   <section id='sotd'>
    <p>
      This is still a work in progress. The proposal is being incubated in the <a href="https://w3c.github.io/chinese-ig/">W3C Web Chinese Interest Group</a>.
    </p>
  </section>
  <section>
    <h2>Introduction</h2>
    <p>
      Bullet Chatting is called comment (コメント/comment) in Japanese. It refers to a comment or a comment floating over the
      video in certain way at a specific point of time of the video, which can bring interesting and unexpected
      experiences to the users while watching the video. Only when a large amount of comments shown up on the screen at the same time,
      people call this state of the player a Danmaku. In China, in order to avoid conflict with the function of the original
      comment, it was renamed as Bullet Chatting.
    </p>
    <p>
      Bullet Chatting first got popular from the Japanese Video vendor Niconico (ニコニコ). In China, besides those video vendor feature in Bullet Chatting such as Bilibili and Acfun, for most of the other video websites, such as MiGu video,
      Tencent video, iQiyi video, Youku video, etc., Bullet Chatting is also provided as a function of the player.

    </p>
    <section>
      <h2>Bullet Chatting attributes</h2>
      <p>
        The Bullet Chatting has the following four attributes:
      </p>
      <ul>
        <li>
          Mode: Rolling Bullet Chatting, reverse Bullet Chatting, top Bullet Chatting, bottom Bullet Chatting.
        </li>
        <li>
          Basic properties: body, appearance time, duration, font, font size, color, etc.
        </li>
        <li>
          Timeline: The on-demand barcorder is a real-time insertion or custom timeline for video playback time, live
          broadcasts, and other scenes.
        </li>
        <li>
          Container: A block-level element, typically the same size as the video.
        </li>
      </ul>
    </section>

    <section>
      <h2>Bullet Chatting characteristics</h2>
      <p>
        There are three types of Bullet Chatting features:
      </p>
      <ol>
        <li>
          Independence of space: Although it is displayed in the same element, each type of Bullet Chatting mode is in
          different layers in spatial calculation, and each mode can have multiple layers, and the Bullet Chatting
          occupancy in each layer does not overlap.
        </li>
        <li>
          Deterministic of rendering: If the Bullet Chatting area and the rendered list are fixed, then the position and
          order of each Bullet Chatting is fixed each time it is rendered.
        </li>
        <li>
          Uniformity of modes: The survival time of the Bullet Chatting of each mode remains the same.
        </li>
        </ul>
    </section>

    <section>
      <h2>Basic mode of the Bullet Chatting</h2>
      <p>
        There are four basic modes of the Bullet Chatting:
      </p>
      <ol>
        <li>
          Rolling Bullet Chatting: Scrolls the screen from the right to the left at a constant speed, showing the
          top-down priority.
        </li>
        <li>
          Reverse Barr: Scrolls the screen from the left to the right at a constant speed, showing the top-down
          priority.
        </li>
        <li>
          Top Bullet Chatting: A Bullet Chatting that is statically centered from top to bottom, with top-down
          priority.
        </li>
        <li>
          Bottom Bullet Chatting: A Bullet Chatting that is centered from the bottom up and is displayed with a
          bottom-up priority.
        </li>
        </ul>
        <p>
          In addition, the Bullet Chatting has a higher level of customization and is not covered by this standard.
        </p>
    </section>

    <section>
      <h2>Commercial operation of the Bullet Chatting</h2>
      <p>
        Bullet Chatting has a wide range of applications in China and Japan, and mainstream video sites and their apps
        have good support and application for Bullet Chatting. The monthly activity of the relevant video website can be
        referred to as follows (only the statistical video website app month):
      </p>
      <ul>
        <li>iQiyi: 575.1677 million per month</li>
        <li>Tencent Video: 467.491 million per month</li>
        <li>Youku: 444.829 million per month</li>
        <li>Mango TV: 100.267 million per month</li>
        <li>Bilibili animation: 80.652 million per month</li>
        <li>Sohu video: 36.35 million per month</li>
        <li>Niconico: 18.74 million per month [<a
            href='https://ssl4.eir-parts.net/doc/9468/ir_material_for_fiscal_ym/64532/00.pdf'>source</a>]</li>
        <li>MiGu video: 15.625 million per month</li>
      </ul>
      <p>Source: <a href='https://www.analysys.cn/article/detail/20019224'>2019 Latest Mobile App TOP1000</a></p>
    </section>

  </section>

  <section>
    <h2>Terms</h2>
    <p>
      <p>
        This document uses the following terms:
      </p>
      <ul>
        <li>
          <dfn>WebVTT</dfn> &mdash; A file format used to mark text tracks.[[webvtt1]]
        </li>
        <li>
          <dfn>TTML</dfn> &mdash; A type of content that represents a time-series text medium that is exchanged between
          authoring systems.[[ttml1]]
        </li>
      </ul>
    </p>
  </section>

  <section>
    <h2>Background</h2>
    <section>
      <h2>Analysis from the perspective of user experience</h2>
      <p>During streaming broadcasting, we often see these two text chatting features to encourage user interaction: Chatroom and Bullet Chatting.</p>
      <figure>
        <img alt="an example of chatroom" src="images/why1.png" width="600">
        <figcaption>
          a figure of Chatroom: with the input of text, the context list will be scrolling to the top at a constant speed. 
        </figcaption>
      </figure>
      <figure>
        <img alt="an example of Bullet Chatting" src="images/why2.png" width="600">
        <figcaption>
          a figure of Bullet Chatting: with the input of text, a single line of text will show up on the right side of the video, moving to the left in an independent path.
        </figcaption>
      </figure>
      <section>
        <h2>Advantage of the display of Bullet Chatting</h2>
        <p>We can see from the below figure that when many people are chatting in the same room during streaming broadcasting, messages will be scrolling quickly, the display time of each message is highly affectly by the chatroom's activity, the more active the users are, the less time the message will be displayed.</p>
        <figure>
          <img alt="the display time of a single message in a chatroom" src="images/why3.png" width="600">
          <figcaption>
            a figure of the display time of a single message in a chatroom
          </figcaption>
        </figure>
        <p>Bullet Chatting tries to provide a better way to display each message when many people are chatting online in the same time,</p>
        <ul>
          <li>
            <p>the density of the messages</p>
            <p>Compared to the chatroom, Bullet Chatting has a wider display area, which provides better user experience of reading for a message with the same font size.</p>
            <figure>
              <img alt="the display time of a single message in Bullet Chatting" src="images/why4.png" width="600">
              <figcaption>
                a figure of the display time of a single message in Bullet Chatting
              </figcaption>
            </figure>
          </li>
        </ul>
      </section>
    </section>
  </section>


  <section data-dfn-for="Foo" data-link-for="Foo">
    <h2>Scenarios</h2>
    This section mainly describes the specific use scenarios of the Bullet Chatting.
    <section>
      <h2>On-demand video interaction</h2>
      <p>
        When watching a video site to provide a video, the viewer will have some ideas or voicing points in the process
        of watching the video content, and want to publish it to share with more people. At this time, a Bullet Chatting
        is needed to meet this demand. Through the Bullet Chatting, the viewer's comments at the same time can be
        displayed in the video area by scrolling in a fixed direction, or statically displayed at the top or bottom of
        the video area, which can increase the interactive characteristics of the viewer and the video and the viewer.
        Interaction between the two. The Bullet Chatting sent at the same time basically has the same theme.
      </p>
      <p>
        In this scenario, the Bullet Chatting data is generally offline data (not real-time), and there is also a small
        amount of real-time data.
      </p>
    </section>
    <section>
      <h2>Live video interaction</h2>
      <p>The Bullet Chatting can also be a direct interaction between the anchor and the viewer in the live video
        scene. Compared with the traditional real-time commentary, the anchor can more intuitively understand the
        audience's needs and feedback according to the display of the Bullet Chatting on the screen, more convenient to
        adjust the next action and processing, and can also interact according to the user's input.</p>
      <p>
        In this scenario, the Bullet Chatting data is generally real-time data.
      </p>
    </section>
    <section>
      <h2>Identify video highlights</h2>
      <p>
        Since the Bullet Chatting will only appear at a specific point in the video, if there is a large number of
        Bullet Chatting at a certain point in time, it means that the time point has bright spots and high energy. The
        audience is interested in this time point event and can also be used as video management and Recommended
        reference data for other functions.
      </p>
    </section>

    <section>
      <h2>Video content enhancement</h2>
      <p>
        In the process of video on demand or live broadcast, there are some stages, the user is not concerned with the
        picture content of the video itself, but the emotions and emotions stimulated by a certain point. At this time,
        the viewer can enhance the video by superimposing on the video by the Bullet Chatting. The effect at this time
        is to achieve a better experience. For example, the victory of the game, the climax of the plot to render the
        atmosphere, or the cover of the horror of the horror to reduce fear.
      </p>
    </section>
    <section>
      <h2>Web page interaction</h2>
      <p>
        Sometimes in order to increase the effect of the page, the product operator hopes to make the relevant content
        into a visual impact of the Bullet Chatting effect, so that the relevant activities can be promoted in the web
        page to increase the impact of the page, attracting The attention of young people increases the income.
      </p>
      <p>
        In this kind of scene, the Bullet Chatting is displayed separately and is not attached to the video.
      </p>
    </section>
    <section>
      <h2>Interactive wall</h2>
      <p>
        On the wall means that the netizen can display the interactive experience of the offline event or conference by
        sending the content of the Bullet Chatting to display the display screen prepared offline at the venue. The
        upper wall can be understood as a purely Bullet Chatting application, which is equivalent to not displaying
        video on the big screen, or even displaying content. It only shows the discussion content of the event site or
        the netizen for the offline event, and enhances the offline event or the meeting atmosphere. Participants have a
        stronger sense of participation.
      </p>
      <p>
        In this kind of scene, the Bullet Chatting is also displayed separately, not attached to the video.
      </p>
    </section>
  </section>

  <section>
    <h2>Recommended interfaces and attributes</h2>
    <section>
      <h2>Sample</h2>
      <aside class="example" title="Bullet Chatting Usage">
        <pre>
          &lt;bulletchatlist area="100" &gt;
            &lt;bulletchat mode="scroll" &gt;This is Content&lt;/bulletchat&gt;
            &lt;bulletchat mode="bottom" &gt;Fixed Content&lt;/bulletchat&gt;
          &lt;/bulletchatlist&gt;
          </pre>
      </aside>
      <p class="note">
        Bullet Chatting make use of new components like
        <code>bulletchatlist</code>和<code>bulletchat</code>，and they are not inherited from
        <code>video</code> or <code>audio</code>.
      </p>
    </section>

    <section>
      <h2>Attributes</h2>

      <section>
        <h2>Bulletchatlist element</h2>
        <ul>
          <li><code>area</code>:Defines the percentage of the total height of the bulletchatlist in the scroll bar and
            the top Bullet Chatting display area, ranging from 0-100, 50 is half screen, 100 is full screen</li>
          <li>
            <code>allowOverlap</code>:Defines whether the Bullet Chatting beyond the display area allows
            overlap.<code>false</code>If the display does not show the Bullet Chatting beyond the display
            area,<code>true</code>it means that the Bullet Chatting will be displayed overlapping the display area.
          </li>
        </ul>
      </section>

      <section>
        <h2>Bulletchat element</h2>
        <ul>
          <li>
            <code>mode</code>:Defines the type of Bullet Chatting, optional
            values<code>scroll</code>,<code>top</code>,<code>bottom</code>and <code>reverse</code>.

            <p><code>scroll</code> The default value indicates the scroll Bullet Chatting. The Bullet Chatting scrolls
              from left to right, and the scrolling time is controlled by the CSS
              property <code>bulletchat-duration</code>. Display time rule: <code>bulletchat</code>the leftmost element
              into the <code>bulletchatlist</code> element area to the display <code>bulletchat</code> element from the
              rightmost <code>bulletchatlist</code> element of the display region disappears time consumed.</p>
            <p><code>top</code> Indicates the top Bullet Chatting.</p>
            <p><code>bottom</code> Indicates the bottom Bullet Chatting.</p>
            <p><code>reverse</code> Represents a reverse scrolling Bullet Chatting. The Bullet Chatting will scroll from
              right to left, and the scrolling time is <code>scroll</code> similar.</p>
          </li>
        </ul>
      </section>
    </section>

    <section>
      <h2>Event</h2>
      <section>
        <h2>Bulletchat element</h2>
        <ul>
          <li><code>bulletchatstart</code>:Triggered when the Bullet Chatting animation starts.</li>
          <li><code>bulletchatend</code>:Triggered when the Bullet Chatting animation ends.</li>
          <li><code>bulletchatcancel</code>:Trigger when the Bullet Chatting is terminated unexpectedly, such as the
            Bullet Chatting is removed or hidden, or because the display area is not displayed.</li>
        </ul>
      </section>
    </section>


    <section>
      <h2>Style</h2>
      <section>
        <h2>Bulletchatlist element</h2>
        <ul>
          <li><code>bulletchat-play-state</code>:running | paused, defines the state of the Bullet Chatting as running
            or paused, and can be inherited.</li>
          <li><code>bulletchat-duration</code>:&lt;time&gt;, in seconds (s) or milliseconds (ms), defines the speed of
            the Bullet Chatting, which can be inherited.</li>
        </ul>
      </section>

      <section>
        <h2>Bulletchat element</h2>
        <ul>
          <li><code>bulletchat-play-state</code>:running | paused, which defines the state of the Bullet Chatting as
            running or paused, which can be inherited.</li>
          <li><code>bulletchat-duration</code>:&lt;time&gt;, in seconds (s) or milliseconds (ms), defines the speed of
            the Bullet Chatting, which can be inherited.</li>
          <li><code>bulletchat-delay</code>:&lt;time&gt;, in seconds (s) or milliseconds (ms), defines when the Bullet
            Chatting animation begins, defining a negative value allows a Bullet Chatting to start moving from the
            middle.
          </li>
          <li>Font size, color, border, line height, transparency, shadow, etc., same as existing CSS attributes.</li>
        </ul>
      </section>
    </section>


  </section>

</body>

</html>